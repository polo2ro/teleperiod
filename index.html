<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Teleperiod sample</title>
        <link rel="stylesheet" type="text/css" href="bower_components/bootstrap-css-only/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="bower_components/bootstrap-css-only/css/bootstrap-theme.min.css">
        <link rel="stylesheet" type="text/css" href="styles/teleperiod.css">

        <script type="text/javascript" src="bower_components/d3/d3.min.js"></script>
        <script type="text/javascript" src="src/timespan-boundary.js"></script>
        <script type="text/javascript" src="src/teleperiod.js"></script>
        <script type="text/javascript" src="src/timeline.js"></script>
        <script type="text/javascript" src="src/selection.js"></script>
    </head>

    <body>

        <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
          <div class="container">
            <div class="navbar-header">
              <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a href="/" class="navbar-brand">Teleperiod</a>
            </div>

          </div>
        </header>

        <div class="container bs-docs-container">

            <div class="row">
                <svg id="teleperiod_placeholder"></svg>
            </div>

            <form>
              <div class="form-group">
                <label for="dtstart">Start date</label>
                <input type="text" class="form-control" id="dtstart" />
              </div>
              <div class="form-group">
                <label for="dtend">End date</label>
                <input type="text" class="form-control" id="dtend" />
              </div>

              <button type="submit" class="btn btn-default">Submit</button>
            </form>
        </div>


        <script type="text/javascript">

            var formatOptions = {year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit" };

            var teleperiod = new teleperiod({
                object: d3.select('#teleperiod_placeholder'),
                workingtimes: function(interval) {

                    var workingtimes = [];
                    var loop = new Date(interval.from);
                    while (loop.getTime() < interval.to.getTime()) {

                        if (loop.getDay() != 0 && loop.getDay() != 6) {

                            var am = {};
                            var pm = {};

                            am.dtstart = new Date(loop);
                            am.dtstart.setHours(9, 0, 0);

                            am.dtend = new Date(loop);
                            am.dtend.setHours(12, 0, 0);

                            pm.dtstart = new Date(loop);
                            pm.dtstart.setHours(13, 0, 0);

                            pm.dtend = new Date(loop);
                            pm.dtend.setHours(18, 0, 0);

                            workingtimes.push(am);
                            workingtimes.push(pm);
                        }

                        loop.setDate(loop.getDate() + 1);
                    }

                    return workingtimes;
                },

                onUpdated: function(selection) {

                    var dtstart = selection.dtstart ? selection.dtstart.toLocaleString() : null;
                    var dtend = selection.dtend ? selection.dtend.toLocaleString() : null;

                    d3.select('#dtstart').attr('value', dtstart);
                    d3.select('#dtend').attr('value', dtend);
                }
            });

            teleperiod.setSize();
            teleperiod.createMain();
        </script>
    </body>
</html>
